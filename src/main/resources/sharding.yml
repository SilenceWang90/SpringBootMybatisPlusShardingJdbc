dataSources:
  ds1:
    dataSourceClassName: com.zaxxer.hikari.HikariDataSource # 必须指定数据源类型
    driverClassName: com.mysql.cj.jdbc.Driver
    jdbcUrl: jdbc:mysql://localhost:3306/sharding_db?useSSL=false&serverTimezone=UTC
    username: root
    password: Wangpeng@90
rules:
  # !SHARDING是YAML中的一种标签（tag），用于标识这部分配置为Sharding规则。
  # 该配置不能省略，否则无法正确读取该配置文件。且下面还有!SINGLE配置是给所有表增加了默认的不分表的配置，如果表不再此处配置声明分表策略，将使用SINGLE的配置不分表查询
- !SHARDING
#  defaultDataSourceName: ds1
  tables:
    test:
      actualDataNodes: ds1.test$->{0..1}
      tableStrategy:
        standard:
          # 分片字段
          shardingColumn: id
          # 分片规则，自定义一个分片规则，名称随意，此处是test_inline
          shardingAlgorithmName: test_inline
  shardingAlgorithms:
    # 自定义的分片规则算法逻辑
    test_inline:
      type: INLINE
      props:
        # $是占位符，{id % 2}是该占位符的实现
        algorithm-expression: test$->{id % 2}
        # 允许支持范围查询，否则默认不支持
        allow-range-query-with-inline-sharding: true
# 必须有该配置，否则没有配置分表策略的表在查询的时候会报错。其中第一个*代表所有数据库，第二个*代表所有表。如果不指定全部可以明确指明数据库名称(数据源)以及表名称
# 该配置相当于给所有的表增加了一个默认配置。即如果没有指明- !SHARDING分表策略，那么这些表都是默认不分表；如果指明了- !SHARDING分表策略，那么就按照分表策略去查询
- !SINGLE
  tables:
    - "*.*"
# 打印实际sql，否则只有逻辑sql。实际sql可以看出来具体查到了哪个分表上
props:
  sql-show: true